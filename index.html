<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Builder Pro - Over 0.5 HT @1.60</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --accent: #238636; --text: #c9d1d9; --gold: #d29922; --win: #2ea043; --loss: #f85149; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        .grid { display: grid; grid-template-columns: 1fr 380px; gap: 20px; }
        textarea { width: 100%; height: 250px; background: #010409; color: #7ee787; border: 1px solid #30363d; padding: 15px; border-radius: 6px; box-sizing: border-box; font-family: 'Courier New', monospace; }
        .panel { background: var(--card); border: 1px solid #30363d; border-radius: 6px; padding: 20px; margin-bottom: 20px; }
        button { background: var(--accent); color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; width: 100%; font-size: 1.1em; }
        button:hover { background: #2ea043; filter: brightness(1.1); }
        .bot-config { background: #010409; border: 1px solid var(--gold); padding: 15px; border-radius: 6px; color: var(--gold); font-family: monospace; line-height: 1.5; }
        .match-entry { border-bottom: 1px solid #30363d; padding: 12px 0; display: flex; justify-content: space-between; align-items: center; }
        .status-win { background: var(--win); color: white; padding: 2px 8px; border-radius: 4px; font-weight: bold; font-size: 0.8em; }
        .status-loss { background: var(--loss); color: white; padding: 2px 8px; border-radius: 4px; font-weight: bold; font-size: 0.8em; }
        .metric { font-size: 0.85em; color: #8b949e; margin-right: 10px; }
        h2, h3 { color: white; margin-top: 0; }
        .highlight { color: #58a6ff; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header" style="text-align:center; margin-bottom: 20px;">
        <h2>‚öΩ Generador de Bots Rentables (HT Strategy)</h2>
        <p>Analiza patrones de presi√≥n para buscar el Gol antes del descanso</p>
    </div>

    <div class="grid">
        <div class="left-col">
            <div class="panel">
                <h3>1. Datos del Reporte</h3>
                <textarea id="dataInput" placeholder="Pega aqu√≠ las filas de tu Excel o Software..."></textarea>
                <button onclick="processData()" style="margin-top: 15px;">Generar Bot de Acuerdo a Patrones</button>
            </div>

            <div class="panel">
                <h3>2. Auditor√≠a de Partidos (Filtro HT)</h3>
                <div id="matchList">Los resultados aparecer√°n aqu√≠...</div>
            </div>
        </div>

        <div class="right-col">
            <div class="panel">
                <h3>ü§ñ Bot Sugerido</h3>
                <div id="botRecommendation" class="bot-config">Esperando an√°lisis...</div>
                <div id="botStats" style="margin-top:15px;"></div>
            </div>

            <div class="panel" style="border-color: #58a6ff;">
                <h3>üìà An√°lisis de Rentabilidad</h3>
                <p style="font-size: 0.9em;">Basado en cuota fija de <span class="highlight">1.60</span>:</p>
                <div id="roiBox"></div>
            </div>
        </div>
    </div>
</div>

<script>
function processData() {
    const input = document.getElementById('dataInput').value;
    const lines = input.split('\n');
    const matchList = document.getElementById('matchList');
    const botRec = document.getElementById('botRecommendation');
    
    let totalAnalyzed = 0;
    let winners = 0;
    matchList.innerHTML = "";

    lines.forEach((line) => {
        if (line.toLowerCase().includes('match') || line.trim() === "") return;
        const cols = line.split('\t');
        if (cols.length < 42) return; // Asegurar que llegamos a la columna Result HT (41)

        const matchName = cols[6];
        const minute = parseInt(cols[7]);
        const apH = parseInt(cols[11]) || 0;
        const apA = parseInt(cols[12]) || 0;
        const shOnH = parseInt(cols[15]) || 0;
        const shOnA = parseInt(cols[16]) || 0;
        const resultHT = cols[41].trim(); // Columna del resultado al descanso

        // L√ìGICA DE GANADO/PERDIDO: Si Result HT es "0-0" es PERDIDA. Cualquier otro es GANADA.
        const isWin = (resultHT !== "0-0" && resultHT !== "");
        
        const totalAP = apH + apA;
        const apMin = totalAP / (minute || 1);
        const totalShots = shOnH + shOnA;

        // Filtro de "Presi√≥n M√≠nima" para que el Bot no sea basura
        if (apMin >= 0.8) {
            totalAnalyzed++;
            if (isWin) winners++;

            const div = document.createElement('div');
            div.className = 'match-entry';
            div.innerHTML = `
                <div>
                    <strong>${matchName}</strong> <span class="metric">(Min ${minute}')</span><br>
                    <span class="metric">Ataques Pel/Min: ${apMin.toFixed(2)}</span>
                    <span class="metric">Tiros On: ${totalShots}</span>
                </div>
                <span class="${isWin ? 'status-win' : 'status-loss'}">
                    ${isWin ? 'GANADA (' + resultHT + ')' : 'PERDIDA (0-0)'}
                </span>
            `;
            matchList.appendChild(div);
        }
    });

    // --- C√ÅLCULO DEL BOT RENTABLE ---
    if (totalAnalyzed > 0) {
        const winRate = ((winners / totalAnalyzed) * 100).toFixed(1);
        const roi = ((winners * 1.60 - totalAnalyzed) / totalAnalyzed * 100).toFixed(1);

        botRec.innerHTML = `
<strong>NOMBRE:</strong> Bot HT_Pressure_v1<br>
<strong>MERCADO:</strong> Over 0.5 Goles HT<br>
<strong>CUOTA ENTRADA:</strong> 1.60<br><br>
<strong>REGLAS DE FILTRADO:</strong><br>
1. Minuto: 15' al 28'<br>
2. Marcador: 0-0<br>
3. AP/Min: > ${apMinRef(totalAnalyzed, winners)}<br>
4. Tiros a Puerta: > 0<br>
5. Posesi√≥n: > 60% (Local o Visitante)
        `;

        document.getElementById('roiBox').innerHTML = `
            <div style="font-size: 1.2em; margin-bottom:10px;">Strike Rate: <span class="highlight">${winRate}%</span></div>
            <div style="font-size: 1.2em; color: ${roi > 0 ? '#3fb950' : '#f85149'}">ROI Esperado: ${roi}%</div>
            <p style="font-size: 0.8em; color: #8b949e; margin-top:10px;">* El ROI se calcula sobre stake plano entrando a cuota 1.60.</p>
        `;
    } else {
        matchList.innerHTML = "No se encontraron datos v√°lidos. Aseg√∫rate de copiar las filas completas incluyendo la columna de Result HT.";
    }
}

function apMinRef(total, wins) {
    const rate = wins/total;
    if (rate > 0.7) return "1.1";
    if (rate > 0.5) return "1.3";
    return "1.5";
}
</script>
</body>
</html>
