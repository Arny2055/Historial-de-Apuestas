<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizador de Patrones de Aciertos</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f9; color: #333; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 100px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; padding: 10px; }
        button { background-color: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #218838; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: center; }
        th { background-color: #f8f9fa; }
        .positive { color: green; font-weight: bold; }
        .negative { color: red; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>ðŸ“Š Analizador de Patrones</h2>
    <p>Introduce tus resultados separados por comas o espacios (ejemplo: <b>1, -1, 1, 1, -1</b> o usa palabras como <b>ganado, perdido</b>).</p>
    
    <textarea id="dataInput" placeholder="Ejemplo: 1, 1, -1, 1, -1, -1, 1"></textarea>
    <br>
    <button onclick="analizarPatrones()">Analizar Coincidencias</button>

    <div id="resultado">
        </div>
</div>

<script>
function analizarPatrones() {
    const input = document.getElementById('dataInput').value;
    // Limpiar datos: convertir a array de nÃºmeros 1 y -1
    const rawData = input.replace(/ganado/gi, "1").replace(/perdido/gi, "-1").split(/[\s,]+/);
    const valores = rawData.map(v => parseInt(v)).filter(v => v === 1 || v === -1);

    if (valores.length < 2) {
        alert("Por favor, introduce al menos 2 resultados para encontrar un patrÃ³n.");
        return;
    }

    let sumaActual = 0;
    let historialSumas = [];
    let patrones = {}; // Objeto para guardar { valorSuma: {aciertos: X, total: Y} }

    // Calcular sumas y registrar quÃ© pasa despuÃ©s de cada suma
    for (let i = 0; i < valores.length - 1; i++) {
        sumaActual += valores[i];
        let siguienteResultado = valores[i+1];

        if (!patrones[sumaActual]) {
            patrones[sumaActual] = { aciertos: 0, total: 0 };
        }

        patrones[sumaActual].total++;
        if (siguienteResultado === 1) {
            patrones[sumaActual].aciertos++;
        }
    }

    renderizarTabla(patrones);
}

function renderizarTabla(patrones) {
    let html = `<table>
        <thead>
            <tr>
                <th>Si la Sumatoria fue...</th>
                <th>Veces Detectado</th>
                <th>Siguiente fue Acierto (%)</th>
                <th>Siguiente fue Error (%)</th>
            </tr>
        </thead>
        <tbody>`;

    // Ordenar claves de menor a mayor
    const sumasOrdenadas = Object.keys(patrones).sort((a, b) => a - b);

    sumasOrdenadas.forEach(suma => {
        let p = patrones[suma];
        let porcAcierto = ((p.aciertos / p.total) * 100).toFixed(2);
        let porcError = (100 - porcAcierto).toFixed(2);

        html += `<tr>
            <td><strong>${suma}</strong></td>
            <td>${p.total}</td>
            <td class="positive">${porcAcierto}%</td>
            <td class="negative">${porcError}%</td>
        </tr>`;
    });

    html += `</tbody></table>`;
    document.getElementById('resultado').innerHTML = html;
}
</script>

</body>
</html>
