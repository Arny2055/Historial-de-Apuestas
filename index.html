<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizador de Sumatorias</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f0f2f5; color: #1c1e21; }
        .container { max-width: 900px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #007bff; text-align: center; }
        textarea { width: 100%; height: 150px; margin-bottom: 15px; border: 2px solid #ddd; border-radius: 8px; padding: 12px; font-family: monospace; resize: vertical; }
        textarea:focus { border-color: #007bff; outline: none; }
        .controls { text-align: center; margin-bottom: 20px; }
        button { background-color: #007bff; color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background-color: #0056b3; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { border: 1px solid #e0e0e0; padding: 14px; text-align: center; }
        th { background-color: #f8f9fa; color: #333; }
        tr:nth-child(even) { background-color: #fafafa; }
        .positive { color: #28a745; font-weight: bold; }
        .negative { color: #dc3545; font-weight: bold; }
        .info { font-size: 0.9em; color: #666; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>游늵 Analizador de Patrones por Sumatoria</h2>
    <p class="info">Pega tu columna de n칰meros (sumatorias). El sistema detectar치 si el siguiente paso subi칩 o baj칩.</p>
    
    <textarea id="dataInput" placeholder="Pega aqu칤 tus datos, por ejemplo:&#10;1&#10;2&#10;1&#10;0&#10;1"></textarea>
    
    <div class="controls">
        <button onclick="analizarSumas()">Analizar Patrones de Siguiente Paso</button>
    </div>

    <div id="resultado"></div>
</div>

<script>
function analizarSumas() {
    const input = document.getElementById('dataInput').value;
    // Convertir el texto en un array de n칰meros, filtrando espacios vac칤os
    const sumas = input.split(/\s+/).map(Number).filter(n => !isNaN(n));

    if (sumas.length < 2) {
        alert("Necesito al menos 2 n칰meros para comparar el cambio.");
        return;
    }

    let patrones = {}; 

    // Recorremos las sumas para ver qu칠 pasa DESPU칄S de cada valor
    for (let i = 0; i < sumas.length - 1; i++) {
        let sumaActual = sumas[i];
        let sumaSiguiente = sumas[i+1];

        // Determinar si el resultado fue Acierto (subi칩) o Fallo (baj칩)
        let resultado = (sumaSiguiente > sumaActual) ? "acierto" : "fallo";

        if (!patrones[sumaActual]) {
            patrones[sumaActual] = { aciertos: 0, fallos: 0, total: 0 };
        }

        patrones[sumaActual].total++;
        if (resultado === "acierto") {
            patrones[sumaActual].aciertos++;
        } else {
            patrones[sumaActual].fallos++;
        }
    }

    renderizarTabla(patrones);
}

function renderizarTabla(patrones) {
    let html = `<table>
        <thead>
            <tr>
                <th>Si la Suma est치 en...</th>
                <th>Veces que ocurri칩</th>
                <th>Prob. de Subir (+1)</th>
                <th>Prob. de Bajar (-1)</th>
            </tr>
        </thead>
        <tbody>`;

    // Ordenar de mayor a menor para ver primero los n칰meros positivos
    const sumasOrdenadas = Object.keys(patrones).sort((a, b) => b - a);

    sumasOrdenadas.forEach(suma => {
        let p = patrones[suma];
        let porcAcierto = ((p.aciertos / p.total) * 100).toFixed(1);
        let porcFallos = ((p.fallos / p.total) * 100).toFixed(1);

        html += `<tr>
            <td><strong>${suma}</strong></td>
            <td>${p.total} datos</td>
            <td class="positive">${porcAcierto}%</td>
            <td class="negative">${porcFallos}%</td>
        </tr>`;
    });

    html += `</tbody></table>`;
    document.getElementById('resultado').innerHTML = html;
}
</script>

</body>
</html>
