<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scanner Pro - Filtro Cuota 1.60</title>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --accent: #10b981;
            --text: #f8fafc;
            --warning: #f59e0b;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); padding: 20px; line-height: 1.6; }
        .container { max-width: 1100px; margin: auto; }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid var(--accent); padding-bottom: 10px; }
        textarea { 
            width: 100%; height: 200px; background: var(--card); color: #4ade80; 
            border: 1px solid #334155; padding: 15px; border-radius: 8px; font-family: monospace;
            box-sizing: border-box; resize: vertical;
        }
        .controls { margin-top: 15px; display: flex; gap: 10px; align-items: center; }
        button { 
            background: var(--accent); color: white; border: none; padding: 12px 25px; 
            border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        button:hover { opacity: 0.9; transform: translateY(-1px); }
        .match-card { 
            background: var(--card); border-right: 4px solid var(--accent); margin: 15px 0; 
            padding: 20px; border-radius: 8px; display: grid; grid-template-columns: 1fr auto;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        .match-info h3 { margin: 0 0 10px 0; color: var(--accent); }
        .stats-grid { display: flex; gap: 20px; font-size: 0.85em; color: #94a3b8; }
        .badge { background: #064e3b; color: #4ade80; padding: 3px 10px; border-radius: 12px; font-size: 0.8em; }
        .score-box { text-align: center; padding: 10px; background: #064e3b; border-radius: 8px; min-width: 80px; }
        .score-val { font-size: 1.5em; font-weight: bold; display: block; }
        .reason-list { margin-top: 10px; font-size: 0.9em; font-style: italic; color: #cbd5e1; }
        .high-conf { border-right-color: #ec4899; } /* Especial para muy alta probabilidad */
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>⚽ Scanner de Patrones - Gol @1.60</h1>
        <p>Optimizado para entradas entre el minuto 20' y 30' (o inicio 2T)</p>
    </div>

    <textarea id="dataInput" placeholder="Pega aquí las filas de tu reporte (incluyendo columnas de Ataques, Tiros y Posesión)..."></textarea>
    
    <div class="controls">
        <button onclick="analyzeData()">Analizar Posibles Entradas</button>
        <span style="font-size: 0.8em; color: #94a3b8;">* Se requiere que los datos mantengan el formato original de columnas.</span>
    </div>

    <div id="results"></div>
</div>

<script>
function analyzeData() {
    const input = document.getElementById('dataInput').value;
    const lines = input.split('\n');
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = '<h2 style="margin-top:30px;">Análisis de Oportunidades:</h2>';

    let found = 0;

    lines.forEach((line, index) => {
        // Ignorar encabezados o líneas vacías
        if (line.toLowerCase().includes('match') || line.trim() === "") return;

        const cols = line.split('\t');
        if (cols.length < 20) return; // Asegurar que hay suficientes columnas

        // Mapeo de columnas basado en tu estructura:
        const match = cols[6];
        const minute = parseInt(cols[7]);
        const homeAP = parseInt(cols[11]) || 0;
        const awayAP = parseInt(cols[12]) || 0;
        const homeShotOn = parseInt(cols[15]) || 0;
        const awayShotOn = parseInt(cols[16]) || 0;
        const homeShotsTot = parseInt(cols[17]) || 0;
        const awayShotsTot = parseInt(cols[18]) || 0;
        const posH = parseInt(cols[23]) || 50;
        const hCorners = parseInt(cols[27]) || 0;
        const aCorners = parseInt(cols[28]) || 0;

        // --- LÓGICA DE FILTRADO PARA CUOTA 1.60 ---
        let score = 0;
        let reasons = [];

        const totalAP = homeAP + awayAP;
        const apPerMinute = totalAP / (minute || 1);
        const totalShotOn = homeShotOn + awayShotOn;
        const totalCorners = hCorners + aCorners;

        // 1. Filtro de Intensidad (Ataques Peligrosos)
        if (apPerMinute >= 1.4) { 
            score += 35; 
            reasons.push("Ritmo de ataque asfixiante"); 
        } else if (apPerMinute >= 1.0) {
            score += 15;
            reasons.push("Presión constante");
        }

        // 2. Filtro de Finalización (Tiros a Puerta)
        if (totalShotOn >= 2) { 
            score += 25; 
            reasons.push("Ya hay puntería (Tiros a puerta)"); 
        }

        // 3. Filtro de Peligro en Área (Córners)
        if (totalCorners >= 3) {
            score += 15;
            reasons.push("Balones frecuentes al área (Córners)");
        }

        // 4. Filtro de Dominio (Posesión)
        if (posH >= 65 || posH <= 35) {
            score += 15;
            reasons.push("Dominio territorial absoluto");
        }

        // 5. Bonus de "Equipo Favorito" (Si el que domina tiene cuota pre-match baja)
        // Basado en las columnas de cuotas (47, 48, 49 aprox)
        const preHome = parseFloat(cols[47]);
        if (preHome < 1.60 && posH > 60) {
            score += 10;
            reasons.push("Favorito presionando");
        }

        // RESULTADO: Solo mostrar si supera un umbral de confianza
        if (score >= 45) {
            found++;
            const isHigh = score >= 70;
            const card = document.createElement('div');
            card.className = `match-card ${isHigh ? 'high-conf' : ''}`;
            
            card.innerHTML = `
                <div class="match-info">
                    <span class="badge">@1.60 Recomendada</span>
                    <h3>${match}</h3>
                    <div class="stats-grid">
                        <span>Min: <b>${minute}'</b></span>
                        <span>AP/Min: <b>${apPerMinute.toFixed(2)}</b></span>
                        <span>Tiros (On): <b>${totalShotOn}</b></span>
                        <span>Córners: <b>${totalCorners}</b></span>
                    </div>
                    <div class="reason-list">Razones: ${reasons.join(' + ')}</div>
                </div>
                <div class="score-box">
                    <span style="font-size:0.7em uppercase">Confianza</span>
                    <span class="score-val">${score}%</span>
                </div>
            `;
            resultsDiv.appendChild(card);
        }
    });

    if (found === 0) {
        resultsDiv.innerHTML += '<p style="text-align:center; padding:20px;">No hay partidos que cumplan los criterios de presión para cuota 1.60 en este momento.</p>';
    }
}
</script>

</body>
</html>
